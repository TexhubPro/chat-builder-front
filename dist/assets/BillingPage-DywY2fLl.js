import{C as Me,r as c,D as Ne,u as Be,m as Ue,a as Ve,o as qe,E as We,b as xe,d as ye,f as Ge,j as e,A as Pe,l as Je,n as Ze,B as ae}from"./index-Cl4obW8r.js";import{A as He,D as Qe,x as Ke,y as Xe,z as Ye,v as H,w as Q,I as j}from"./DashboardLayout-C4OrwLBC.js";import{e as et,g as tt,u as st,b as at,c as z}from"./usePageSeo-C-NJn5fi.js";import{$ as rt}from"./useLabel-CHYhfvUF.js";import{t as nt,a as re}from"./chunk-ML27DD5T-dmIp4L9i.js";import{m as it,a as lt}from"./chunk-R7OT77UN-MKUcjduT.js";import{a as ve}from"./chunk-VF35X3H6-DenNg_FE.js";import{c as ne}from"./chunk-EIRINNCE-CTmjl7oq.js";import"./index-L9Vv239F.js";import"./index-CqnmybEa.js";import"./useListState-_PN8grmZ.js";let ie=new Map,ce=!1;try{ce=new Intl.NumberFormat("de-DE",{signDisplay:"exceptZero"}).resolvedOptions().signDisplay==="exceptZero"}catch{}let K=!1;try{K=new Intl.NumberFormat("de-DE",{style:"unit",unit:"degree"}).resolvedOptions().style==="unit"}catch{}const _e={degree:{narrow:{default:"°","ja-JP":" 度","zh-TW":"度","sl-SI":" °"}}};class ot{format(t){let s="";if(!ce&&this.options.signDisplay!=null?s=dt(this.numberFormatter,this.options.signDisplay,t):s=this.numberFormatter.format(t),this.options.style==="unit"&&!K){var r;let{unit:i,unitDisplay:l="short",locale:o}=this.resolvedOptions();if(!i)return s;let u=(r=_e[i])===null||r===void 0?void 0:r[l];s+=u[o]||u.default}return s}formatToParts(t){return this.numberFormatter.formatToParts(t)}formatRange(t,s){if(typeof this.numberFormatter.formatRange=="function")return this.numberFormatter.formatRange(t,s);if(s<t)throw new RangeError("End date must be >= start date");return`${this.format(t)} – ${this.format(s)}`}formatRangeToParts(t,s){if(typeof this.numberFormatter.formatRangeToParts=="function")return this.numberFormatter.formatRangeToParts(t,s);if(s<t)throw new RangeError("End date must be >= start date");let r=this.numberFormatter.formatToParts(t),i=this.numberFormatter.formatToParts(s);return[...r.map(l=>({...l,source:"startRange"})),{type:"literal",value:" – ",source:"shared"},...i.map(l=>({...l,source:"endRange"}))]}resolvedOptions(){let t=this.numberFormatter.resolvedOptions();return!ce&&this.options.signDisplay!=null&&(t={...t,signDisplay:this.options.signDisplay}),!K&&this.options.style==="unit"&&(t={...t,style:"unit",unit:this.options.unit,unitDisplay:this.options.unitDisplay}),t}constructor(t,s={}){this.numberFormatter=ct(t,s),this.options=s}}function ct(a,t={}){let{numberingSystem:s}=t;if(s&&a.includes("-nu-")&&(a.includes("-u-")||(a+="-u-"),a+=`-nu-${s}`),t.style==="unit"&&!K){var r;let{unit:o,unitDisplay:u="short"}=t;if(!o)throw new Error('unit option must be provided with style: "unit"');if(!(!((r=_e[o])===null||r===void 0)&&r[u]))throw new Error(`Unsupported unit ${o} with unitDisplay = ${u}`);t={...t,style:"decimal"}}let i=a+(t?Object.entries(t).sort((o,u)=>o[0]<u[0]?-1:1).join():"");if(ie.has(i))return ie.get(i);let l=new Intl.NumberFormat(a,t);return ie.set(i,l),l}function dt(a,t,s){if(t==="auto")return a.format(s);if(t==="never")return a.format(Math.abs(s));{let r=!1;if(t==="always"?r=s>0||Object.is(s,0):t==="exceptZero"&&(Object.is(s,-0)||Object.is(s,0)?s=Math.abs(s):r=s>0),r){let i=a.format(-s),l=a.format(s),o=i.replace(l,"").replace(/\u200e|\u061C/,"");return[...o].length!==1&&console.warn("@react-aria/i18n polyfill for NumberFormat signDisplay: Unsupported case"),i.replace(l,"!!!").replace(o,"+").replace("!!!",l)}else return a.format(s)}}function ut(a={}){let{locale:t}=Me();return c.useMemo(()=>new ot(t,a),[t,a])}var je=Ne({slots:{base:"flex flex-col gap-2 w-full",label:"",labelWrapper:"flex justify-between",value:"",track:"z-0 relative bg-default-300/50 overflow-hidden rtl:rotate-180",indicator:"h-full"},variants:{color:{default:{indicator:"bg-default-400"},primary:{indicator:"bg-primary"},secondary:{indicator:"bg-secondary"},success:{indicator:"bg-success"},warning:{indicator:"bg-warning"},danger:{indicator:"bg-danger"}},size:{sm:{label:"text-small",value:"text-small",track:"h-1"},md:{label:"text-medium",value:"text-medium",track:"h-3"},lg:{label:"text-large",value:"text-large",track:"h-5"}},radius:{none:{track:"rounded-none",indicator:"rounded-none"},sm:{track:"rounded-small",indicator:"rounded-small"},md:{track:"rounded-medium",indicator:"rounded-medium"},lg:{track:"rounded-large",indicator:"rounded-large"},full:{track:"rounded-full",indicator:"rounded-full"}},isStriped:{true:{indicator:"bg-stripe-gradient-default bg-stripe-size"}},isIndeterminate:{true:{indicator:["absolute","w-full","origin-left","animate-indeterminate-bar"]}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:{},false:{indicator:"transition-transform !duration-500"}}},defaultVariants:{color:"primary",size:"md",radius:"full",isStriped:!1,isIndeterminate:!1,isDisabled:!1},compoundVariants:[{disableAnimation:!0,isIndeterminate:!1,class:{indicator:"!transition-none motion-reduce:transition-none"}},{color:"primary",isStriped:!0,class:{indicator:"bg-stripe-gradient-primary bg-stripe-size"}},{color:"secondary",isStriped:!0,class:{indicator:"bg-stripe-gradient-secondary bg-stripe-size"}},{color:"success",isStriped:!0,class:{indicator:"bg-stripe-gradient-success bg-stripe-size"}},{color:"warning",isStriped:!0,class:{indicator:"bg-stripe-gradient-warning bg-stripe-size"}},{color:"danger",isStriped:!0,class:{indicator:"bg-stripe-gradient-danger bg-stripe-size"}}]},{twMerge:!0});Ne({slots:{base:"flex flex-col justify-center gap-1 max-w-fit items-center",label:"",svgWrapper:"relative block",svg:"z-0 relative overflow-hidden",track:"h-full stroke-default-300/50",indicator:"h-full stroke-current",value:"absolute font-normal inset-0 flex items-center justify-center"},variants:{color:{default:{svg:"text-default-400"},primary:{svg:"text-primary"},secondary:{svg:"text-secondary"},success:{svg:"text-success"},warning:{svg:"text-warning"},danger:{svg:"text-danger"}},size:{sm:{svg:"w-8 h-8",label:"text-small",value:"text-[0.5rem]"},md:{svg:"w-10 h-10",label:"text-small",value:"text-[0.55rem]"},lg:{svg:"w-12 h-12",label:"text-medium",value:"text-[0.6rem]"}},isIndeterminate:{true:{svg:"animate-spinner-ease-spin"}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:{},false:{indicator:"transition-all !duration-500"}}},defaultVariants:{color:"primary",size:"md",isDisabled:!1},compoundVariants:[{disableAnimation:!0,isIndeterminate:!1,class:{svg:"!transition-none motion-reduce:transition-none"}}]});function mt(a={}){const{rerender:t=!1,delay:s=0}=a,r=c.useRef(!1),[i,l]=c.useState(!1);return c.useEffect(()=>{r.current=!0;let o=null;return t&&(s>0?o=setTimeout(()=>{l(!0)},s):l(!0)),()=>{r.current=!1,t&&l(!1),o&&clearTimeout(o)}},[t]),[c.useCallback(()=>r.current,[]),i]}function ft(a){let{value:t=0,minValue:s=0,maxValue:r=100,valueLabel:i,isIndeterminate:l,formatOptions:o={style:"percent"}}=a,u=et(a,{labelable:!0}),{labelProps:m,fieldProps:g}=rt({...a,labelElementType:"span"});t=He(t,s,r);let p=(t-s)/(r-s),_=ut(o);if(!l&&!i){let w=o.style==="percent"?p:t;i=_.format(w)}return{progressBarProps:tt(u,{...g,"aria-valuenow":l?void 0:t,"aria-valuemin":s,"aria-valuemax":r,"aria-valuetext":l?void 0:i,role:"progressbar"}),labelProps:m}}function pt(a){var t,s;const r=Be(),[i,l]=Ue(a,je.variantKeys),{ref:o,as:u,id:m,className:g,classNames:p,label:_,valueLabel:w,value:C=0,minValue:I=0,maxValue:k=100,showValueLabel:X=!1,formatOptions:B={style:"percent"},...D}=i,U=u||"div",L=st(o),O=Ve(p?.base,g),[,Y]=mt({rerender:!0,delay:100}),S=a.isIndeterminate,T=(s=(t=a.disableAnimation)!=null?t:r?.disableAnimation)!=null?s:!1,{progressBarProps:A,labelProps:V}=ft({id:m,label:_,value:C,minValue:I,maxValue:k,valueLabel:w,formatOptions:B,isIndeterminate:S,"aria-labelledby":a["aria-labelledby"],"aria-label":a["aria-label"]}),y=c.useMemo(()=>je({...l,disableAnimation:T}),[qe(l),T]),$=T?!0:Y,q=c.useMemo(()=>S||!$?void 0:We((C-I)/(k-I)*100),[$,S,C,I,k]),W=c.useCallback((F={})=>({ref:L,"data-indeterminate":ye(S),"data-disabled":ye(a.isDisabled),className:y.base({class:O}),...xe(A,D,F)}),[L,y,S,a.isDisabled,O,A,D]),h=c.useCallback((F={})=>({className:y.label({class:p?.label}),...xe(V,F)}),[y,p,V]);return{Component:U,domRef:L,slots:y,classNames:p,label:_,percentage:q,showValueLabel:X,getProgressBarProps:W,getLabelProps:h}}var Se=Ge((a,t)=>{const{Component:s,slots:r,classNames:i,label:l,percentage:o,showValueLabel:u,getProgressBarProps:m,getLabelProps:g}=pt({...a,ref:t}),p=m(),_=l||u;return e.jsxs(s,{...p,children:[_?e.jsxs("div",{className:r.labelWrapper({class:i?.labelWrapper}),children:[l&&e.jsx("span",{...g(),children:l}),u&&e.jsx("span",{className:r.value({class:i?.value}),children:p["aria-valuetext"]})]}):null,e.jsx("div",{className:r.track({class:i?.track}),children:e.jsx("div",{className:r.indicator({class:i?.indicator}),style:{transform:`translateX(-${100-(o||0)}%)`}})})]})});Se.displayName="HeroUI.Progress";var bt=Se;const ht="http://127.0.0.1:8000/api".replace(/\/$/,"");async function gt(a){return(a.headers.get("content-type")??"").includes("application/json")?a.json():null}async function M(a,t,s={}){const r=new Headers(s.headers??{});r.has("Accept")||r.set("Accept","application/json"),typeof s.body<"u"&&s.body!==null&&!r.has("Content-Type")&&r.set("Content-Type","application/json"),r.set("Authorization",`Bearer ${t}`);const i=await fetch(`${ht}${a}`,{...s,headers:r}),l=await gt(i);if(!i.ok){const o=typeof l=="object"&&l!==null&&"message"in l&&typeof l.message=="string"?l.message:"Request failed.";throw new Pe(o,i.status,l)}return l}async function xt(a){return(await M("/billing/plans",a,{method:"GET"})).plans}async function yt(a){return M("/billing/subscription",a,{method:"GET"})}async function vt(a){return(await M("/billing/invoices",a,{method:"GET"})).invoices}async function jt(a,t){return M("/billing/checkout",a,{method:"POST",body:JSON.stringify(t)})}async function wt(a,t){return M(`/billing/invoices/${t}/pay`,a,{method:"POST"})}function Nt(a){return a===90?"90":a===180?"180":"30"}function x(a,t,s){const r=typeof a=="number"?a:Number(a);return Number.isFinite(r)?new Intl.NumberFormat(s==="ru"?"ru-RU":"en-US",{style:"currency",currency:t,maximumFractionDigits:2}).format(r):`${a} ${t}`}function le(a,t){if(!a)return"-";const s=new Date(a);return Number.isNaN(s.getTime())?"-":new Intl.DateTimeFormat(t==="ru"?"ru-RU":"en-US",{dateStyle:"medium"}).format(s)}function we(a,t){return a<=0?t==="ru"?"30 дней":"30 days":t==="ru"?`${a} дней`:`${a} days`}function Pt(a){return a?a.included_chats<=0?a.used_chats>0?100:0:Math.max(0,Math.min(100,Math.round(a.used_chats/a.included_chats*100))):0}function _t(a,t,s,r){if(!a||!t||!s||!r||s.status!=="active"||a.currency!==t.currency)return 0;const i=Math.max(r.included_chats,0),l=Math.max(r.used_chats,0),o=Math.max(i-l,0);if(i<=0||o<=0)return 0;const u=Number(t.price),m=Math.max(s.quantity,1);if(!Number.isFinite(u)||u<=0)return 0;const g=u*m*o/i;if(!Number.isFinite(g)||g<=0)return 0;const p=Number(a.price);return!Number.isFinite(p)||p<=0?0:Math.min(g,p)}function St(a,t,s){if(!a||!t||!s||t.status!=="active")return 0;const r=Math.max(s.included_chats,0),i=Math.max(s.used_chats,0),l=Math.max(r-i,0);if(r<=0||l<=0)return 0;const o=Number(a.price),u=Math.max(t.quantity,1);if(!Number.isFinite(o)||o<=0)return 0;const m=o*u*l/r;return!Number.isFinite(m)||m<=0?0:m}function $t(a,t,s){if(!a||!t||!s||s.status!=="active"||a.code===t.code)return!1;const r=Math.max(a.billing_period_days/30,1),i=Math.max(t.billing_period_days/30,1),l=Number(a.price)/r,o=Number(t.price)/i,u=a.included_chats<t.included_chats||a.assistant_limit<t.assistant_limit||a.integrations_per_channel_limit<t.integrations_per_channel_limit,m=Number.isFinite(l)&&Number.isFinite(o)&&l<o;return u||m}function Ct(a){if(!a.features||typeof a.features!="object")return 0;const t=a.features.discount_percent,s=typeof t=="number"?t:Number(t);return!Number.isFinite(s)||s<=0?0:Math.round(s)}function kt(a,t){switch(a){case"active":return{label:t.statusActive,color:"success"};case"pending_payment":return{label:t.statusPendingPayment,color:"warning"};case"inactive":return{label:t.statusInactive,color:"default"};case"past_due":return{label:t.statusPastDue,color:"danger"};case"unpaid":return{label:t.statusUnpaid,color:"danger"};case"expired":return{label:t.statusExpired,color:"danger"};case"canceled":return{label:t.statusCanceled,color:"default"};default:return{label:t.statusUnknown,color:"default"}}}function Dt(a,t){switch(a){case"pending":return{label:t.statusPending,color:"warning"};case"paid":return{label:t.statusPaid,color:"success"};case"issued":return{label:t.statusIssued,color:"warning"};case"overdue":return{label:t.statusOverdue,color:"danger"};case"failed":return{label:t.statusFailed,color:"danger"};case"void":return{label:t.statusVoid,color:"default"};default:return{label:t.statusUnknown,color:"default"}}}function E(a,t){const s=a.trim().toLowerCase();return s==="checkout created. complete payment to activate subscription."?t.checkoutCreated:s==="payment completed successfully."?t.paymentCompleted:s==="payment session created. continue in alif."?t.paymentSessionCreated:s==="invoice is already paid."?t.paymentAlreadyCompleted:s==="unauthenticated."?t.unauthorized:a}function oe(a,t){return a instanceof Pe||a instanceof Error?E(a.message,t):t.loadFailed}function Tt(a){return a==="issued"||a==="overdue"||a==="failed"}function It(a,t){const s=document.createElement("form");s.method="POST",s.action=a,s.style.display="none";for(const[r,i]of Object.entries(t)){const l=document.createElement("input");l.type="hidden",l.name=r,l.value=i,s.appendChild(l)}document.body.appendChild(s),s.submit()}function Wt(){const{user:a,logout:t}=Je(),{locale:s,messages:r}=Ze(),[i,l]=c.useState([]),[o,u]=c.useState(null),[m,g]=c.useState(null),[p,_]=c.useState([]),[w,C]=c.useState(""),[I,k]=c.useState(!0),[X,B]=c.useState(!1),[D,U]=c.useState(!1),[L,O]=c.useState(null),[Y,S]=c.useState(!1),[T,A]=c.useState(!1),[V,y]=c.useState(!1),[$,q]=c.useState("30"),[W,h]=c.useState(null),[F,R]=c.useState(null);at({title:`${r.billing.title} | ${r.app.name}`,description:r.billing.subtitle,locale:s});const G=async n=>{const f=ae();if(!f){h(r.billing.unauthorized),k(!1);return}n?k(!0):B(!0);try{const[d,v,te]=await Promise.all([xt(f),yt(f),vt(f)]);l(d),u(v.subscription),g(v.usage),_(te);const ze=v.subscription?.status==="active";A(P=>ze?P:!0);const se=v.subscription?.plan?.code,Z=se&&d.some(P=>P.code===se)?se:d[0]?.code??"",Oe=d.find(P=>P.code===Z)??null,he=Nt(Oe?.billing_period_days),ge=d.filter(P=>String(P.billing_period_days)===he),Ee=ge.some(P=>P.code===Z)?Z:ge[0]?.code??Z;q(he),C(Ee)}catch(d){h(oe(d,r.billing))}finally{k(!1),B(!1)}};c.useEffect(()=>{G(!0)},[]);const b=c.useMemo(()=>i.find(n=>n.code===w)??null,[i,w]),de=c.useMemo(()=>i.filter(n=>String(n.billing_period_days)===$),[i,$]),N=c.useMemo(()=>{const n=o?.plan?.code;if(n){const f=i.find(d=>d.code===n);if(f)return f}return b},[i,b,o?.plan?.code]),ue=c.useMemo(()=>St(N,o,m),[N,o,m]),ee=c.useMemo(()=>_t(b,N,o,m),[b,N,o,m]),me=c.useMemo(()=>b?Math.max(ue-Number(b.price),0):0,[ue,b]),$e=b?Math.max(Number(b.price)-ee,0):0,fe=Pt(m),J=o?.status==="active",Ce=!J||T,ke=c.useMemo(()=>$t(b,N,o),[b,N,o])&&me>0,pe=kt(o?.status,r.billing),De=[{key:"included",icon:"solar:chat-line-linear",label:r.billing.includedChats,value:String(m?.included_chats??0)},{key:"used",icon:"solar:chat-round-dots-linear",label:r.billing.usedChats,value:String(m?.used_chats??0)},{key:"remaining",icon:"solar:clock-circle-linear",label:r.billing.remainingChats,value:String(m?.remaining_chats??0)},{key:"overage",icon:"solar:danger-triangle-linear",label:r.billing.overageChats,value:String(m?.overage_chats??0)},{key:"assistants",icon:"solar:users-group-rounded-linear",label:r.billing.assistantLimit,value:String(m?.assistant_limit??0)},{key:"integrations",icon:"solar:link-minimalistic-2-linear",label:r.billing.integrationLimit,value:String(m?.integrations_per_channel_limit??0)}],Te=async()=>{S(!0);try{await t()}finally{S(!1)}},Ie=async()=>{h(null),R(null),await G(!1)},be=async()=>{if(h(null),R(null),!w){h(r.billing.checkoutFailed);return}const n=ae();if(!n){h(r.billing.unauthorized);return}U(!0);try{const f=await jt(n,{plan_code:w,quantity:1});R(E(f.message,r.billing)),await G(!1)}catch(f){h(oe(f,r.billing))}finally{U(!1)}},Le=async()=>{if(ke){y(!0);return}await be()},Ae=async()=>{y(!1),await be()},Fe=n=>{if(n!=="30"&&n!=="90"&&n!=="180")return;const f=n,d=i.filter(v=>String(v.billing_period_days)===f);q(f),C(v=>d.some(te=>te.code===v)?v:d[0]?.code??v)},Re=async n=>{h(null),R(null);const f=ae();if(!f){h(r.billing.unauthorized);return}O(n);try{const d=await wt(f,n);if(d.payment?.provider==="alifbank"&&d.payment.method==="post"&&d.payment.checkout_url){R(E(d.message,r.billing)),It(d.payment.checkout_url,d.payment.payload);return}R(E(d.message,r.billing)),A(!1),await G(!1)}catch(d){h(oe(d,r.billing))}finally{O(null)}};return e.jsx(Qe,{title:r.billing.title,user:a,onLogout:Te,isLoggingOut:Y,defaultSelectedKey:"billing",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ke,{isOpen:V,onOpenChange:y,placement:"center",children:e.jsxs(Xe,{children:[e.jsx(it,{children:r.billing.downgradeWarningTitle}),e.jsxs(Ye,{children:[e.jsx("p",{className:"text-sm text-default-700",children:r.billing.downgradeWarningDescription}),e.jsxs("p",{className:"text-sm font-semibold text-danger-600",children:[r.billing.downgradeWarningForfeit,":"," ",b?x(me,b.currency,s):x("0","USD",s)]})]}),e.jsxs(lt,{children:[e.jsx(z,{variant:"light",onPress:()=>y(!1),isDisabled:D,children:r.billing.downgradeCancelButton}),e.jsx(z,{color:"danger",onPress:Ae,isLoading:D,children:r.billing.downgradeConfirmButton})]})]})}),W?e.jsx(ve,{color:"danger",title:r.billing.errorTitle,description:W,variant:"flat"}):null,F?e.jsx(ve,{color:"success",title:r.billing.successTitle,description:F,variant:"flat"}):null,e.jsxs("div",{className:`grid grid-cols-1 gap-4 ${J?"xl:grid-cols-[minmax(0,1fr)_minmax(0,1fr)]":""}`,children:[J?e.jsx(H,{shadow:"none",className:"border border-default-200 bg-white",children:e.jsxs(Q,{className:"space-y-3 p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-default-500",children:r.billing.currentSubscriptionTitle})}),e.jsx(ne,{size:"sm",color:pe.color,variant:"flat",children:pe.label})]}),e.jsxs("div",{className:"rounded-large bg-gradient-to-br from-indigo-600 via-violet-600 to-fuchsia-600 p-4 text-white",children:[e.jsxs("div",{className:"flex items-end justify-between gap-3",children:[e.jsx("div",{children:e.jsx("p",{className:"text-xl font-semibold",children:o?.plan?.name??"-"})}),e.jsx("p",{className:"text-xl font-bold",children:N?x(N.price,N.currency,s):x("0","TJS",s)})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-white/90",children:[e.jsxs("p",{children:[r.billing.cycleLabel,":"," ",e.jsx("strong",{children:we(o?.billing_cycle_days??30,s)})]}),e.jsxs("p",{children:[r.billing.expiresLabel,":"," ",e.jsx("strong",{children:le(o?.expires_at??null,s)})]})]}),e.jsxs("div",{className:"mt-3 space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-white/85",children:[e.jsx("span",{children:r.billing.usageProgress}),e.jsxs("span",{className:"font-semibold text-white",children:[fe,"%"]})]}),e.jsx(bt,{"aria-label":r.billing.usageProgress,value:fe,size:"sm",color:"default",classNames:{track:"bg-white/25",indicator:"bg-white"}})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(z,{variant:"bordered",onPress:Ie,isLoading:X,children:r.billing.refreshButton}),e.jsx(z,{color:"primary",variant:T?"solid":"flat",onPress:()=>A(n=>!n),children:T?r.billing.hidePlanUpdateButton:r.billing.updatePlanButton})]})]})}):null,J?e.jsx(H,{shadow:"none",className:"border border-default-200 bg-white",children:e.jsxs(Q,{className:"space-y-3 p-5",children:[e.jsx("p",{className:"text-sm font-medium text-default-500",children:r.billing.usageTitle}),e.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:De.map(n=>e.jsxs("div",{className:"rounded-medium border border-default-200 bg-default-50 p-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-default-500",children:[e.jsx(j,{icon:n.icon,width:14}),e.jsx("p",{className:"text-[11px] leading-tight",children:n.label})]}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-foreground",children:n.value})]},n.key))})]})}):null]}),Ce?e.jsx(H,{shadow:"none",className:"border border-default-200 bg-white",children:e.jsxs(Q,{className:"space-y-4 p-5",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:s==="ru"?"Доступные тарифы для вас":"Available plans for you"}),e.jsx("p",{className:"text-sm text-default-500",children:s==="ru"?"Выберите подходящий тариф и выставьте счет.":"Choose the right plan and create an invoice."})]}),e.jsxs(nt,{"aria-label":s==="ru"?"Период тарифа":"Plan duration",selectedKey:$,onSelectionChange:n=>Fe(String(n)),color:"primary",variant:"bordered",radius:"full",size:"sm",fullWidth:!0,disableAnimation:!0,children:[e.jsx(re,{title:s==="ru"?"1 месяц":"1 month"},"30"),e.jsx(re,{title:e.jsxs("span",{className:`inline-flex items-center gap-2 ${$==="90"?"py-0.5 pr-0.5":""}`,children:[e.jsx("span",{children:s==="ru"?"3 месяца":"3 months"}),e.jsx("span",{className:"rounded-full bg-success-100 px-2 py-0 text-[11px] font-semibold text-success-700",children:"-10%"})]})},"90"),e.jsx(re,{title:e.jsxs("span",{className:`inline-flex items-center gap-2 ${$==="180"?"py-0.5 pr-0":""}`,children:[e.jsx("span",{children:s==="ru"?"6 месяцев":"6 months"}),e.jsx("span",{className:"rounded-full bg-success-100 px-2 py-0.5 text-[11px] font-semibold text-success-700",children:"-20%"})]})},"180")]}),de.length===0?e.jsx("p",{className:"text-sm text-default-500",children:r.billing.noPlansAvailable}):e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:de.map(n=>{const f=w===n.code,d=Ct(n);return e.jsxs("button",{type:"button",onClick:()=>C(n.code),className:`rounded-large border p-4 text-left transition-colors ${f?"border-primary bg-primary/10":"border-default-200 bg-white hover:bg-default-50"}`,children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-semibold text-foreground",children:n.name}),e.jsxs("div",{className:"mt-0.5 flex flex-wrap items-center gap-2",children:[e.jsx("p",{className:"text-xs text-default-500",children:we(n.billing_period_days,s)}),d>0?e.jsx(ne,{size:"sm",color:"success",variant:"flat",children:s==="ru"?`Скидка ${d}%`:`Save ${d}%`}):null]})]}),e.jsx("p",{className:"text-lg font-bold text-foreground",children:x(n.price,n.currency,s)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-default-700",children:[e.jsx(j,{icon:"solar:chat-line-linear",width:16}),e.jsxs("span",{children:[r.billing.includedChats,":"," ",n.included_chats]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-default-700",children:[e.jsx(j,{icon:"solar:users-group-rounded-linear",width:16}),e.jsxs("span",{children:[r.billing.assistantLimit,":"," ",n.assistant_limit]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-default-700",children:[e.jsx(j,{icon:"solar:link-minimalistic-2-linear",width:16}),e.jsxs("span",{children:[r.billing.integrationLimit,":"," ",n.integrations_per_channel_limit]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-default-700",children:[e.jsx(j,{icon:"solar:dollar-minimalistic-linear",width:16}),e.jsx("span",{children:s==="ru"?`После исчерпания лимита: ${x(n.overage_chat_price,n.currency,s)} за 1 чат`:`After included limit: ${x(n.overage_chat_price,n.currency,s)} per extra chat`})]}),e.jsx("div",{className:"pt-1 text-xs font-medium text-default-500",children:s==="ru"?"Доступные каналы интеграции":"Available channels"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-default-700",children:[e.jsx(j,{icon:"fa6-brands:instagram",width:15}),e.jsx("span",{children:"Instagram"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-default-700",children:[e.jsx(j,{icon:"solar:plain-2-linear",width:16}),e.jsx("span",{children:"Telegram"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-default-700",children:[e.jsx(j,{icon:"solar:widget-2-linear",width:16}),e.jsx("span",{children:s==="ru"?"Виджет чата для сайта":"Website chat widget"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-default-700",children:[e.jsx(j,{icon:"solar:code-square-linear",width:16}),e.jsx("span",{children:s==="ru"?"API интеграция":"API integration"})]})]}),f?e.jsxs("div",{className:"mt-3 inline-flex items-center gap-1 rounded-full bg-primary/15 px-2 py-1 text-xs font-medium text-primary",children:[e.jsx(j,{icon:"solar:check-circle-linear",width:14}),e.jsx("span",{children:r.billing.selectedPlan})]}):null]},n.id)})}),e.jsxs("div",{className:"flex flex-col gap-3 rounded-medium border border-default-200 bg-default-50 p-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-default-500",children:r.billing.totalToPayLabel}),e.jsx("p",{className:"text-xl font-semibold text-foreground",children:b?x($e,b.currency,s):x("0","TJS",s)}),ee>0&&b?e.jsxs("p",{className:"text-xs text-success-600",children:[r.billing.creditAppliedLabel,":"," ",x(ee,b.currency,s)]}):null]}),e.jsx(z,{color:"primary",isLoading:D,onPress:Le,children:D?r.billing.checkoutProcessing:r.billing.checkoutButton})]})]})}):null,e.jsx(H,{shadow:"none",className:"border border-default-200 bg-white",children:e.jsxs(Q,{className:"space-y-3 p-5",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:r.billing.invoicesTitle}),e.jsx("p",{className:"text-sm text-default-500",children:r.billing.invoicesSubtitle})]}),I?e.jsx("p",{className:"text-sm text-default-500",children:r.common.loadingSession}):p.length===0?e.jsx("p",{className:"text-sm text-default-500",children:r.billing.noInvoices}):e.jsx("div",{className:"space-y-2",children:p.map(n=>{const f=Dt(n.status,r.billing),d=Tt(n.status);return e.jsxs("div",{className:"flex flex-col gap-3 rounded-medium border border-default-200 p-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:n.number}),e.jsxs("p",{className:"text-xs text-default-500",children:[r.billing.invoiceDate,":"," ",le(n.created_at,s)]}),e.jsxs("p",{className:"text-xs text-default-500",children:[r.billing.invoiceDue,":"," ",le(n.due_at,s)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:x(n.total,n.currency,s)}),e.jsx(ne,{size:"sm",color:f.color,variant:"flat",children:f.label}),d?e.jsx(z,{size:"sm",color:"primary",isLoading:L===n.id,onPress:()=>Re(n.id),children:L===n.id?r.billing.payingButton:r.billing.payButton}):null]})]},n.id)})})]})})]})})}export{Wt as default};
