import{g as q,n as z,r as d,j as a,L as A,Z as B,A as M}from"./index-Cl4obW8r.js";import{f as V,j as _,e as k,n as T,k as $,i as D,m as G,h as O,l as U,b as S}from"./validation-Dr_-wTAJ.js";import{b as H,B as R,L as W,c as Z}from"./usePageSeo-C-NJn5fi.js";import{i as g}from"./chunk-SQIAVXJX-B8YR62C3.js";import{a as J}from"./chunk-VF35X3H6-DenNg_FE.js";import{l as K}from"./chunk-SIOPM2FD-RbdruiLz.js";import"./index-CqnmybEa.js";import"./useLabel-CHYhfvUF.js";import"./chunk-ICU6NNET-DePoEaEU.js";function Q(u){return typeof u=="object"&&u!==null}function X(u){const e=(Q(u.data)?u.data:void 0)?.errors;if(!e)return{};const l=o=>{const v=e[o];if(!Array.isArray(v))return;const m=v[0];return typeof m=="string"?m:void 0},w=l("name"),h=l("email"),x=l("phone"),p=l("password"),b=l("password_confirmation");return{...w?{name:w}:{},...h?{email:h}:{},...x?{phone:x}:{},...p?{password:p}:{},...b?{passwordConfirmation:b}:{}}}function le(){const u=q(),{locale:P,messages:e}=z(),[l,w]=d.useState(""),[h,x]=d.useState(""),[p,b]=d.useState(""),[o,v]=d.useState(""),[m,L]=d.useState(""),[I,C]=d.useState(!1),[y,f]=d.useState(null),[t,r]=d.useState({});H({title:`${e.auth.registerTitle} | ${e.app.name}`,description:e.auth.registerSubtitle,locale:P});const F=async i=>{i.preventDefault(),f(null),r({});const s=k(l),j=T(h),E=$(p),c={};if(!s||!j||!E||!o||!m){s||(c.name=e.auth.requiredRegisterFields),j||(c.email=e.auth.requiredRegisterFields),E||(c.phone=e.auth.requiredRegisterFields),o||(c.password=e.auth.requiredRegisterFields),m||(c.passwordConfirmation=e.auth.requiredRegisterFields),r(c);return}if(s.length<2){r({name:e.auth.invalidName});return}if(!D(j)){r({email:e.auth.invalidEmail});return}if(!G(E)){r({phone:e.auth.invalidPhone});return}if(o.length<=6){r({password:e.auth.passwordTooShort});return}if(!O(o)){r({password:e.auth.weakPassword});return}if(o!==m){r({passwordConfirmation:e.auth.passwordMismatch});return}C(!0),f(null),r({});try{const n=await B({name:s,email:j,phone:E,password:o});u(`/verify-email?email=${encodeURIComponent(n.email)}`,{replace:!0,state:{email:n.email,resendAvailableIn:n.resend_available_in}})}catch(n){if(n instanceof M){const N=U(X(n),e);if(Object.keys(N).length>0){r(N);return}f(S(n.message,e));return}if(n instanceof Error){f(S(n.message,e));return}f(e.auth.registerFailed)}finally{C(!1)}};return a.jsx("main",{className:"flex min-h-screen items-center justify-center bg-white px-4 py-8",children:a.jsxs("div",{className:"w-full max-w-72",children:[a.jsxs("header",{className:"mb-6 flex items-start justify-between gap-3",children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("img",{src:R.logoUrl,alt:R.logoAlt,className:"h-10 w-10 rounded-md object-contain"})}),a.jsx(W,{})]}),a.jsxs("div",{className:"mb-5",children:[a.jsx("h1",{className:"text-3xl font-bold leading-tight text-foreground",children:e.auth.registerTitle}),a.jsx("p",{className:"mt-1 text-base text-default-600",children:e.auth.registerSubtitle})]}),a.jsxs("form",{className:"flex flex-col gap-4",onSubmit:F,noValidate:!0,children:[a.jsx(g,{isRequired:!0,autoComplete:"name",label:e.auth.nameLabel,labelPlacement:"outside",placeholder:e.auth.namePlaceholder,value:l,onValueChange:i=>{w(V(i)),t.name&&r(s=>({...s,name:void 0}))},variant:"bordered",maxLength:255,isInvalid:!!t.name,errorMessage:t.name}),a.jsx(g,{isRequired:!0,autoComplete:"email",type:"email",label:e.auth.emailLabel,labelPlacement:"outside",placeholder:e.auth.emailPlaceholder,value:h,onValueChange:i=>{x(i),t.email&&r(s=>({...s,email:void 0}))},variant:"bordered",maxLength:255,isInvalid:!!t.email,errorMessage:t.email}),a.jsx(g,{isRequired:!0,autoComplete:"tel",type:"tel",inputMode:"tel",label:e.auth.phoneLabel,labelPlacement:"outside",placeholder:e.auth.phonePlaceholder,value:p,onValueChange:i=>{b(_(i)),t.phone&&r(s=>({...s,phone:void 0}))},variant:"bordered",maxLength:32,isInvalid:!!t.phone,errorMessage:t.phone}),a.jsx(g,{isRequired:!0,autoComplete:"new-password",type:"password",label:e.auth.passwordLabel,labelPlacement:"outside",placeholder:e.auth.passwordPlaceholder,value:o,onValueChange:i=>{v(i),t.password&&r(s=>({...s,password:void 0}))},variant:"bordered",maxLength:255,description:t.password?void 0:e.auth.passwordRulesHint,isInvalid:!!t.password,errorMessage:t.password}),a.jsx(g,{isRequired:!0,autoComplete:"new-password",type:"password",label:e.auth.confirmPasswordLabel,labelPlacement:"outside",placeholder:e.auth.confirmPasswordPlaceholder,value:m,onValueChange:i=>{L(i),t.passwordConfirmation&&r(s=>({...s,passwordConfirmation:void 0}))},variant:"bordered",maxLength:255,isInvalid:!!t.passwordConfirmation,errorMessage:t.passwordConfirmation}),y?a.jsx(J,{color:"danger",title:e.auth.errorTitle,description:y,variant:"flat"}):null,a.jsx(Z,{type:"submit",color:"primary",isLoading:I,fullWidth:!0,children:e.auth.registerButton})]}),a.jsxs("p",{className:"mt-4 text-center text-small text-default-500",children:[e.auth.haveAccount," ",a.jsx(K,{as:A,to:"/login",size:"sm",children:e.auth.signIn})]})]})})}export{le as default};
