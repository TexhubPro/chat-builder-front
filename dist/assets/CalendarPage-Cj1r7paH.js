import{t as et,A as Q,l as tt,n as st,r as d,q as le,j as t,s as nt}from"./index-DQLtrWDr.js";import{a as at,D as it,c as oe,b as de,I as B,s as be,m as je,d as Ne,e as _e}from"./DashboardLayout-Ch-JahUG.js";import{b as rt,c as ce,d as v}from"./usePageSeo-DV5FTLGl.js";import{s as R,l as K}from"./chunk-C3QHEOC2-C8-kVpbd.js";import{d as lt}from"./index-QqL6eDdC.js";import{c as L}from"./chunk-EIRINNCE-CVqZGRLV.js";import{m as we}from"./chunk-R7OT77UN-BRtO6pa6.js";import{m as ve}from"./chunk-5LXTSPS7-Drxrr-_M.js";import{i as T}from"./chunk-SQIAVXJX-CskShjr8.js";import{t as ot}from"./chunk-WEIB4WXA-DN0GzwLX.js";import"./useLabel-DMs0yI3Y.js";import"./chunk-KQW2TNLT-CQQZWck-.js";import"./chunk-ICU6NNET-BrfXip-f.js";import"./useListState-CXfC96AV.js";import"./index-Bjiuu4dL.js";async function dt(a){return(a.headers.get("content-type")??"").includes("application/json")?a.json():null}async function X(a,r,i={}){const s=new Headers(i.headers??{});s.has("Accept")||s.set("Accept","application/json"),typeof i.body<"u"&&i.body!==null&&!s.has("Content-Type")&&s.set("Content-Type","application/json"),s.set("Authorization",`Bearer ${r}`);const l=await fetch(`${et}${a}`,{...i,headers:s}),f=await dt(l);if(!l.ok){const x=typeof f=="object"&&f!==null&&"message"in f&&typeof f.message=="string"?f.message:"Request failed.";throw new Q(x,l.status,f)}return f}function ct(a){const r=new URLSearchParams;Object.entries(a).forEach(([s,l])=>{typeof l>"u"||r.set(s,String(l))});const i=r.toString();return i===""?"":`?${i}`}async function ut(a,r={}){const i=ct({from:r.from,to:r.to,assistant_id:r.assistant_id,status:r.status});return X(`/calendar/events${i}`,a,{method:"GET"})}async function mt(a,r){return X("/calendar/events",a,{method:"POST",body:JSON.stringify(r)})}async function ft(a,r,i){return X(`/calendar/events/${r}`,a,{method:"PUT",body:JSON.stringify(i)})}async function ht(a,r){return X(`/calendar/events/${r}`,a,{method:"DELETE"})}const pt=["scheduled","confirmed","completed","canceled","no_show"],Ce=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],xt=[15,30,45,60,90,120];function b(a){return String(a).padStart(2,"0")}function me(){const a=new Date;return`${a.getFullYear()}-${b(a.getMonth()+1)}-${b(a.getDate())}`}function Ee(a){const[r,i]=a.split("-"),s=Number.parseInt(r??"",10),l=Number.parseInt(i??"",10);if(!Number.isFinite(s)||!Number.isFinite(l)||l<1||l>12){const _=me().slice(0,7);return Ee(_)}const f=`${s}-${b(l)}-01`,x=new Date(s,l,0),y=`${s}-${b(l)}-${b(x.getDate())}`;return{from:f,to:y}}function gt(a){return String(a)}function H(a){const r=a.match(/^(\d{2}):(\d{2})$/);if(!r)return null;const i=Number.parseInt(r[1],10),s=Number.parseInt(r[2],10);return!Number.isFinite(i)||!Number.isFinite(s)||i<0||i>23||s<0||s>59?null:i*60+s}function yt(a){const r=Math.floor(a/60),i=a%60;return`${b(r)}:${b(i)}`}function ue(a,r){if(!a)return"";const i=new Date(a);if(Number.isNaN(i.getTime()))return"";const l=new Intl.DateTimeFormat("en-CA",{timeZone:r,year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(i),f=l.find(N=>N.type==="year")?.value??"",x=l.find(N=>N.type==="month")?.value??"",y=l.find(N=>N.type==="day")?.value??"";return f&&x&&y?`${f}-${x}-${y}`:""}function U(a,r){if(!a)return"";const i=new Date(a);if(Number.isNaN(i.getTime()))return"";const l=new Intl.DateTimeFormat("en-GB",{timeZone:r,hour:"2-digit",minute:"2-digit",hourCycle:"h23"}).formatToParts(i),f=l.find(y=>y.type==="hour")?.value??"",x=l.find(y=>y.type==="minute")?.value??"";return f&&x?`${f}:${x}`:""}function bt(a,r){const i=new Date(`${a}T12:00:00`),s=new Intl.DateTimeFormat("en-US",{weekday:"long",timeZone:r}).format(i).toLowerCase();return Ce.includes(s)?s:"monday"}function Se(a,r,i){if(!a)return"-";const s=new Date(a);return Number.isNaN(s.getTime())?"-":new Intl.DateTimeFormat(i==="ru"?"ru-RU":"en-US",{timeZone:r,day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit",hourCycle:"h23"}).format(s)}function jt(a){const r=a.trim();if(r==="")return"?";const i=r.split(/\s+/u).filter(Boolean),s=i[0]?.[0]??"",l=i[1]?.[0]??"";return`${s}${l}`.trim().toUpperCase()||r.slice(0,1).toUpperCase()}function Ie(a){switch(a){case"confirmed":return"primary";case"completed":return"success";case"canceled":case"no_show":return"danger";case"scheduled":return"warning";default:return"default"}}function Nt(a){const[r,i]=a.split("-"),s=Number.parseInt(r??"",10),l=Number.parseInt(i??"",10)-1;if(!Number.isFinite(s)||!Number.isFinite(l))return[];const x=(new Date(s,l,1).getDay()+6)%7,y=new Date(s,l+1,0).getDate(),N=new Date(s,l,0).getDate(),_=[];for(let F=0;F<42;F+=1){const D=F-x+1;if(D<1){const I=N+D,M=new Date(s,l-1,I);_.push({dateKey:`${M.getFullYear()}-${b(M.getMonth()+1)}-${b(I)}`,dayNumber:I,isCurrentMonth:!1});continue}if(D>y){const I=D-y,M=new Date(s,l+1,I);_.push({dateKey:`${M.getFullYear()}-${b(M.getMonth()+1)}-${b(I)}`,dayNumber:I,isCurrentMonth:!1});continue}_.push({dateKey:`${s}-${b(l+1)}-${b(D)}`,dayNumber:D,isCurrentMonth:!0})}return _}function _t(a,r,i){const[s,l]=a.split("-"),f=Number.parseInt(s??"",10),x=Number.parseInt(l??"",10);if(!Number.isFinite(f)||!Number.isFinite(x))return a;const y=new Date(`${a}-01T12:00:00`);return new Intl.DateTimeFormat(r==="ru"?"ru-RU":"en-US",{timeZone:i,month:"long",year:"numeric"}).format(y)}function wt(a,r,i){const s=new Date(`${a}T12:00:00`);return new Intl.DateTimeFormat(r==="ru"?"ru-RU":"en-US",{timeZone:i,weekday:"long",day:"2-digit",month:"long"}).format(s)}function De(a){return{title:"",description:"",clientName:"",clientPhone:"",clientEmail:"",date:a.date,time:a.time,durationMinutes:String(a.slotMinutes),status:"scheduled",assistantId:"none",serviceId:"none",location:"",meetingLink:""}}function Me(a){return[...a].sort((r,i)=>{const s=r.starts_at?new Date(r.starts_at).getTime():0,l=i.starts_at?new Date(i.starts_at).getTime():0;return s-l})}function At(){const{user:a,logout:r}=tt(),{locale:i,messages:s}=st(),l=at(),[f,x]=d.useState(!1),[y,N]=d.useState(!0),[_,F]=d.useState(!1),[D,I]=d.useState(null),[M,Z]=d.useState(!1),[Le,ee]=d.useState(!1),[q,Te]=d.useState([]),[V,$e]=d.useState([]),[te,Fe]=d.useState([]),[se,ze]=d.useState(!0),[h,ke]=d.useState("UTC"),[w,Oe]=d.useState(30),[fe,Pe]=d.useState({monday:{is_day_off:!1,start_time:"09:00",end_time:"18:00"},tuesday:{is_day_off:!1,start_time:"09:00",end_time:"18:00"},wednesday:{is_day_off:!1,start_time:"09:00",end_time:"18:00"},thursday:{is_day_off:!1,start_time:"09:00",end_time:"18:00"},friday:{is_day_off:!1,start_time:"09:00",end_time:"18:00"},saturday:{is_day_off:!0,start_time:null,end_time:null},sunday:{is_day_off:!0,start_time:null,end_time:null}}),[S,Y]=d.useState(me()),[ne,Ae]=d.useState("all"),[z,W]=d.useState(null),[m,ae]=d.useState(null),[o,g]=d.useState(De({date:me(),time:"09:00",slotMinutes:30})),[he,j]=d.useState(null),[pe,k]=d.useState(null);rt({title:`${s.calendar.title} | ${s.app.name}`,description:s.calendar.subtitle,locale:i});const $=S.slice(0,7),O=d.useCallback(async()=>{const e=le();if(!e){j(s.calendar.unauthorized),N(!1);return}const n=Ee($),c=Number.parseInt(ne,10),p=Number.isFinite(c)?c:void 0;N(!0),j(null);try{const u=await ut(e,{from:n.from,to:n.to,assistant_id:p});Te(Me(u.events)),$e(u.assistants),Fe(u.services),ze(u.appointments_enabled),ke(u.timezone),Oe(u.slot_minutes),Pe(u.business_schedule)}catch(u){j(u instanceof Q?u.message:s.calendar.loadFailed)}finally{N(!1)}},[ne,s.calendar.loadFailed,s.calendar.unauthorized,$]);d.useEffect(()=>{O()},[O]);const Be=async()=>{x(!0);try{await r()}finally{x(!1)}},Re=d.useMemo(()=>Nt($),[$]),Ke=d.useMemo(()=>{const e=new Map;return q.forEach(n=>{const c=ue(n.starts_at,h);c&&e.set(c,(e.get(c)??0)+1)}),e},[h,q]),G=d.useMemo(()=>Me(q.filter(e=>ue(e.starts_at,h)===S)),[h,q,S]),P=d.useMemo(()=>{const e=bt(S,h);return fe[e]??{is_day_off:!0,start_time:null,end_time:null}},[fe,h,S]),ie=d.useMemo(()=>{const e=Number.parseInt(o.assistantId,10);return Number.isFinite(e)?e:null},[o.assistantId]),J=d.useMemo(()=>ie?te.filter(e=>e.assistant_id===null?!0:e.assistant_id===ie):te,[ie,te]);d.useEffect(()=>{const e=Number.parseInt(o.serviceId,10);Number.isFinite(e)&&(J.some(n=>n.id===e)||g(n=>({...n,serviceId:"none"})))},[o.serviceId,J]);const xe=d.useMemo(()=>G.filter(e=>e.status==="scheduled"||e.status==="confirmed").map(e=>{const n=H(U(e.starts_at,h)),c=H(U(e.ends_at,h)),p=e.duration_minutes??w;return n===null?null:{start:n,end:c??n+p,eventId:e.id}}).filter(e=>e!==null),[h,G,w]),ge=d.useMemo(()=>{if(P.is_day_off)return[];const e=H(P.start_time??""),n=H(P.end_time??"");if(e===null||n===null||n<=e)return[];const c=[];for(let p=e;p+w<=n;p+=w){const u=p+w,C=xe.some(A=>A.start<u&&A.end>p);c.push({time:yt(p),disabled:C})}return c},[xe,P,w]),ye=d.useCallback(e=>{W(null),j(null),g(De({date:S,time:e??"09:00",slotMinutes:w})),l.onOpen()},[l,S,w]),Ue=d.useCallback(e=>{const n=ue(e.starts_at,e.timezone||h)||S,c=U(e.starts_at,e.timezone||h)||"09:00";W(e),j(null),g({title:e.title,description:e.description??"",clientName:e.client?.name??"",clientPhone:e.client?.phone??"",clientEmail:e.client?.email??"",date:n,time:c,durationMinutes:String(e.duration_minutes??w),status:e.status,assistantId:e.assistant?.id?String(e.assistant.id):"none",serviceId:e.service?.id?String(e.service.id):"none",location:e.location??"",meetingLink:e.meeting_link??""}),l.onOpen()},[h,l,S,w]),qe=d.useCallback(e=>{ae(e),ee(!0)},[]),Ve=d.useCallback(()=>{_||(l.onClose(),W(null))},[l,_]),Ye=async()=>{if(_)return;const e=le();if(!e){j(s.calendar.unauthorized);return}const n=o.title.trim(),c=o.clientName.trim(),p=o.clientPhone.trim(),u=Number.parseInt(o.durationMinutes,10);if(n.length<2||c.length<2||p===""||o.date===""||o.time===""||!Number.isFinite(u)||u<15||u>720){j(s.calendar.requiredFields);return}if(o.meetingLink.trim()!=="")try{const E=new URL(o.meetingLink.trim());if(E.protocol!=="http:"&&E.protocol!=="https:"){j(s.calendar.invalidMeetingLink);return}}catch{j(s.calendar.invalidMeetingLink);return}const C=Number.parseInt(o.assistantId,10),A=Number.parseInt(o.serviceId,10);F(!0),j(null),k(null);try{const E={title:n,description:o.description.trim()===""?void 0:o.description.trim(),date:o.date,time:o.time,duration_minutes:u,timezone:h,status:o.status,location:o.location.trim()===""?void 0:o.location.trim(),meeting_link:o.meetingLink.trim()===""?void 0:o.meetingLink.trim(),assistant_id:o.assistantId==="none"?null:Number.isFinite(C)?C:void 0,assistant_service_id:o.serviceId==="none"?null:Number.isFinite(A)?A:void 0,company_client_id:z?.client?.id,client_name:c,client_phone:p,client_email:o.clientEmail.trim()===""?void 0:o.clientEmail.trim()};z?(await ft(e,z.id,E),k(s.calendar.updatedSuccess)):(await mt(e,E),k(s.calendar.createdSuccess)),l.onClose(),W(null),await O(),Y(o.date),Z(!0)}catch(E){j(E instanceof Q?E.message:s.calendar.saveFailed)}finally{F(!1)}},We=async e=>{const n=le();if(!n){j(s.calendar.unauthorized);return}I(e.id),j(null),k(null);try{await ht(n,e.id),k(s.calendar.deletedSuccess),await O()}catch(c){j(c instanceof Q?c.message:s.calendar.deleteFailed)}finally{I(null)}},Ge=()=>{const[e,n]=$.split("-"),c=Number.parseInt(e??"",10),p=Number.parseInt(n??"",10);if(!Number.isFinite(c)||!Number.isFinite(p))return;const u=new Date(c,p-2,1),C=`${u.getFullYear()}-${b(u.getMonth()+1)}-01`;Y(C)},Je=()=>{const[e,n]=$.split("-"),c=Number.parseInt(e??"",10),p=Number.parseInt(n??"",10);if(!Number.isFinite(c)||!Number.isFinite(p))return;const u=new Date(c,p,1),C=`${u.getFullYear()}-${b(u.getMonth()+1)}-01`;Y(C)},He=e=>({monday:s.businessSettings.mondayLabel,tuesday:s.businessSettings.tuesdayLabel,wednesday:s.businessSettings.wednesdayLabel,thursday:s.businessSettings.thursdayLabel,friday:s.businessSettings.fridayLabel,saturday:s.businessSettings.saturdayLabel,sunday:s.businessSettings.sundayLabel})[e],re=e=>{switch(e){case"scheduled":return s.calendar.statusScheduled;case"confirmed":return s.calendar.statusConfirmed;case"completed":return s.calendar.statusCompleted;case"canceled":return s.calendar.statusCanceled;case"no_show":return s.calendar.statusNoShow;default:return e}},Qe=d.useMemo(()=>[{id:"all",name:s.calendar.allAssistants},...V.map(e=>({id:String(e.id),name:e.name}))],[V,s.calendar.allAssistants]),Xe=d.useMemo(()=>[{id:"none",name:s.calendar.noAssistant},...V.map(e=>({id:String(e.id),name:e.name}))],[V,s.calendar.noAssistant]),Ze=d.useMemo(()=>[{id:"none",name:s.calendar.noService},...J.map(e=>({id:String(e.id),name:e.name}))],[s.calendar.noService,J]);return t.jsxs(it,{title:s.calendar.title,user:a,onLogout:Be,isLoggingOut:f,defaultSelectedKey:"calendar",children:[t.jsxs("div",{className:"space-y-4",children:[he?t.jsx(ce,{color:"danger",variant:"faded",title:s.calendar.errorTitle,description:he}):null,pe?t.jsx(ce,{color:"success",variant:"faded",title:s.calendar.successTitle,description:pe}):null,se?null:t.jsx(ce,{color:"warning",variant:"faded",title:s.calendar.appointmentsDisabledTitle,description:s.calendar.appointmentsDisabledDescription}),t.jsxs("div",{className:"grid gap-4 xl:grid-cols-[320px_minmax(0,1fr)]",children:[t.jsx(oe,{shadow:"none",className:`border border-default-200 bg-white ${M?"hidden xl:flex":"flex"}`,children:t.jsxs(de,{className:"gap-4",children:[t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-semibold text-foreground",children:s.calendar.monthTitle}),t.jsx("p",{className:"text-xs text-default-500",children:_t($,i,h)})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(v,{isIconOnly:!0,size:"sm",variant:"light",onPress:Ge,"aria-label":s.calendar.prevMonthButton,children:t.jsx(B,{icon:"solar:alt-arrow-left-linear",width:18})}),t.jsx(v,{isIconOnly:!0,size:"sm",variant:"light",onPress:Je,"aria-label":s.calendar.nextMonthButton,children:t.jsx(B,{icon:"solar:alt-arrow-right-linear",width:18})})]})]}),t.jsx(R,{label:s.calendar.assistantFilterLabel,selectedKeys:[ne],onSelectionChange:e=>{const n=String(Array.from(e)[0]??"all");Ae(n)},disallowEmptySelection:!0,size:"sm",children:Qe.map(e=>t.jsx(K,{children:e.name},e.id))}),t.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-[11px] font-medium text-default-500",children:Ce.map(e=>t.jsx("div",{className:"truncate",children:He(e).slice(0,2)},e))}),t.jsx("div",{className:"grid grid-cols-7 gap-1",children:Re.map(e=>{const n=e.dateKey===S,c=Ke.get(e.dateKey)??0;return t.jsxs("button",{type:"button",onClick:()=>{Y(e.dateKey),Z(!0)},className:`relative rounded-medium border px-1 py-2 text-center text-xs transition ${n?"border-primary bg-primary-50 text-primary":e.isCurrentMonth?"border-default-200 bg-default-50 text-foreground hover:bg-default-100":"border-default-100 bg-default-100/60 text-default-400"}`,children:[t.jsx("span",{className:"font-medium",children:gt(e.dayNumber)}),c>0?t.jsx("span",{className:"absolute -right-1 -top-1 inline-flex min-h-4 min-w-4 items-center justify-center rounded-full bg-primary px-1 text-[10px] text-white",children:c>9?"9+":c}):null]},e.dateKey)})}),t.jsx(lt,{}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-default-500",children:s.calendar.quickCreateTitle}),P.is_day_off?t.jsx("p",{className:"rounded-medium border border-warning-200 bg-warning-50 px-3 py-2 text-xs text-warning-700",children:s.calendar.dayOffMessage}):ge.length===0?t.jsx("p",{className:"rounded-medium border border-default-200 bg-default-100 px-3 py-2 text-xs text-default-500",children:s.calendar.noSlots}):t.jsx(be,{className:"max-h-[188px]",children:t.jsx("div",{className:"grid grid-cols-3 gap-2",children:ge.map(e=>t.jsx(v,{size:"sm",variant:e.disabled?"bordered":"flat",color:e.disabled?"default":"primary",isDisabled:e.disabled||!se,onPress:()=>{ye(e.time)},className:"h-8 min-w-0",children:e.time},e.time))})})]})]})}),t.jsx(oe,{shadow:"none",className:`border border-default-200 bg-white ${M?"flex":"hidden xl:flex"}`,children:t.jsxs(de,{className:"gap-4",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(v,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>{Z(!1)},className:"xl:hidden","aria-label":s.calendar.backToMonthButton,children:t.jsx(B,{icon:"solar:alt-arrow-left-linear",width:18})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-base font-semibold text-foreground",children:wt(S,i,h)}),t.jsxs("p",{className:"text-xs text-default-500",children:[s.calendar.timezoneLabel,": ",h]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(v,{size:"sm",variant:"bordered",startContent:t.jsx(B,{icon:"solar:refresh-linear",width:16}),onPress:()=>{O()},children:s.calendar.refreshButton}),t.jsx(v,{size:"sm",color:"primary",startContent:t.jsx(B,{icon:"solar:add-circle-linear",width:16}),onPress:()=>{ye()},isDisabled:!se,children:s.calendar.addEventButton})]})]}),y?t.jsx("div",{className:"flex min-h-[280px] items-center justify-center",children:t.jsx(nt,{size:"sm"})}):G.length===0?t.jsx("div",{className:"flex min-h-[220px] items-center justify-center rounded-large border border-dashed border-default-300 bg-default-50 px-4 text-center text-sm text-default-500",children:s.calendar.emptyForDay}):t.jsx(be,{className:"max-h-[560px]",children:t.jsx("div",{className:"grid gap-2.5 pr-1 xl:grid-cols-2",children:G.map(e=>t.jsx(oe,{shadow:"none",className:"border border-default-200 bg-white",children:t.jsx(de,{className:"p-3",children:t.jsxs("div",{className:"space-y-2.5",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{className:"min-w-0 space-y-0.5",children:[t.jsx("p",{className:"truncate text-sm font-semibold leading-5 text-foreground",children:e.title}),t.jsxs("p",{className:"text-xs text-default-500",children:[Se(e.starts_at,e.timezone||h,i),e.ends_at?` - ${U(e.ends_at,e.timezone||h)}`:""]})]}),t.jsx(L,{size:"sm",variant:"flat",color:Ie(e.status),className:"shrink-0",children:re(e.status)})]}),e.client?t.jsxs("div",{className:"flex items-center gap-2 rounded-medium bg-default-50 px-2.5 py-2",children:[t.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-full bg-default-200 text-xs font-semibold text-default-700",children:jt(e.client.name)}),t.jsxs("div",{className:"min-w-0 leading-tight",children:[t.jsx("p",{className:"truncate text-sm font-medium text-foreground",children:e.client.name}),t.jsx("p",{className:"truncate text-xs text-default-500",children:e.client.phone})]})]}):null,t.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 text-xs text-default-600",children:[e.assistant?t.jsx(L,{size:"sm",variant:"flat",children:e.assistant.name}):null,e.service?t.jsx(L,{size:"sm",variant:"flat",children:e.service.name}):null,e.location?t.jsx(L,{size:"sm",variant:"flat",children:e.location}):null]}),t.jsxs("div",{className:"grid w-full grid-cols-3 gap-2 pt-1",children:[t.jsx(v,{size:"sm",color:"primary",variant:"flat",fullWidth:!0,onPress:()=>{qe(e)},"aria-label":s.calendar.viewDetailsButton,children:s.calendar.viewDetailsButton}),t.jsx(v,{size:"sm",color:"primary",variant:"flat",fullWidth:!0,onPress:()=>{Ue(e)},"aria-label":s.calendar.editButton,children:s.calendar.editButton}),t.jsx(v,{size:"sm",color:"danger",variant:"flat",fullWidth:!0,isLoading:D===e.id,onPress:()=>{We(e)},"aria-label":s.calendar.deleteButton,children:s.calendar.deleteButton})]})]})})},e.id))})})]})})]})]}),t.jsx(je,{isOpen:Le,onOpenChange:e=>{ee(e),e||ae(null)},size:"lg",children:t.jsxs(Ne,{children:[t.jsx(we,{children:s.calendar.viewDetailsButton}),t.jsx(_e,{className:"space-y-3",children:m?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-sm font-semibold text-foreground",children:m.title}),t.jsxs("p",{className:"text-xs text-default-500",children:[Se(m.starts_at,m.timezone||h,i),m.ends_at?` - ${U(m.ends_at,m.timezone||h)}`:""]})]}),t.jsx(L,{size:"sm",variant:"flat",color:Ie(m.status),children:re(m.status)}),m.client?t.jsxs("div",{className:"rounded-medium bg-default-50 p-3 text-sm",children:[t.jsx("p",{className:"font-medium text-foreground",children:m.client.name}),t.jsx("p",{className:"text-default-600",children:m.client.phone}),m.client.email?t.jsx("p",{className:"text-default-500",children:m.client.email}):null]}):null,t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[m.assistant?t.jsx(L,{size:"sm",variant:"flat",children:m.assistant.name}):null,m.service?t.jsx(L,{size:"sm",variant:"flat",children:m.service.name}):null,m.location?t.jsx(L,{size:"sm",variant:"flat",children:m.location}):null]}),m.description?t.jsx("p",{className:"rounded-medium bg-default-50 p-3 text-sm text-default-700",children:m.description}):null]}):null}),t.jsx(ve,{children:t.jsx(v,{variant:"light",onPress:()=>{ee(!1),ae(null)},children:s.calendar.cancelButton})})]})}),t.jsx(je,{isOpen:l.isOpen,onOpenChange:l.onOpenChange,size:"3xl",children:t.jsxs(Ne,{children:[t.jsx(we,{children:z?s.calendar.editModalTitle:s.calendar.createModalTitle}),t.jsxs(_e,{className:"gap-3",children:[t.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[t.jsx(T,{label:s.calendar.titleLabel,value:o.title,onValueChange:e=>{g(n=>({...n,title:e}))}}),t.jsx(R,{label:s.calendar.statusLabel,selectedKeys:[o.status],onSelectionChange:e=>{const n=String(Array.from(e)[0]??"scheduled");g(c=>({...c,status:n}))},disallowEmptySelection:!0,children:pt.map(e=>t.jsx(K,{children:re(e)},e))})]}),t.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[t.jsx(T,{type:"date",label:s.calendar.dateLabel,value:o.date,onValueChange:e=>{g(n=>({...n,date:e}))}}),t.jsx(T,{type:"time",label:s.calendar.timeLabel,value:o.time,onValueChange:e=>{g(n=>({...n,time:e}))}}),t.jsx(R,{label:s.calendar.durationLabel,selectedKeys:[o.durationMinutes],onSelectionChange:e=>{const n=String(Array.from(e)[0]??w);g(c=>({...c,durationMinutes:n}))},disallowEmptySelection:!0,children:Array.from(new Set([...xt,w])).sort((e,n)=>e-n).map(e=>t.jsx(K,{children:`${e} ${s.businessSettings.minutesUnit}`},String(e)))})]}),t.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[t.jsx(T,{label:s.calendar.clientNameLabel,value:o.clientName,onValueChange:e=>{g(n=>({...n,clientName:e}))}}),t.jsx(T,{label:s.calendar.clientPhoneLabel,value:o.clientPhone,onValueChange:e=>{g(n=>({...n,clientPhone:e}))}}),t.jsx(T,{label:s.calendar.clientEmailLabel,value:o.clientEmail,onValueChange:e=>{g(n=>({...n,clientEmail:e}))}})]}),t.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[t.jsx(R,{label:s.calendar.assistantLabel,selectedKeys:[o.assistantId],items:Xe,onSelectionChange:e=>{const n=String(Array.from(e)[0]??"none");g(c=>({...c,assistantId:n==="none"?"none":n,serviceId:"none"}))},disallowEmptySelection:!0,children:e=>t.jsx(K,{children:e.name},e.id)}),t.jsx(R,{label:s.calendar.serviceLabel,selectedKeys:[o.serviceId],items:Ze,onSelectionChange:e=>{const n=String(Array.from(e)[0]??"none");g(c=>({...c,serviceId:n==="none"?"none":n}))},disallowEmptySelection:!0,children:e=>t.jsx(K,{children:e.name},e.id)})]}),t.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[t.jsx(T,{label:s.calendar.locationLabel,value:o.location,onValueChange:e=>{g(n=>({...n,location:e}))}}),t.jsx(T,{label:s.calendar.meetingLinkLabel,value:o.meetingLink,onValueChange:e=>{g(n=>({...n,meetingLink:e}))}})]}),t.jsx(ot,{label:s.calendar.descriptionLabel,minRows:3,value:o.description,onValueChange:e=>{g(n=>({...n,description:e}))}})]}),t.jsxs(ve,{children:[t.jsx(v,{variant:"light",onPress:Ve,isDisabled:_,children:s.calendar.cancelButton}),t.jsx(v,{color:"primary",onPress:Ye,isLoading:_,children:z?s.calendar.saveButton:s.calendar.createButton})]})]})})]})}export{At as default};
